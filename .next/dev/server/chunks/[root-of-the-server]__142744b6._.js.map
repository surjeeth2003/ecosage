{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ASUS/Desktop/ecosage/pages/api/suggest.js"],"sourcesContent":["// pages/api/suggest.js\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== \"POST\") {\r\n    return res.status(405).json({ error: \"Only POST method allowed\" });\r\n  }\r\n\r\n  const { product_name } = req.body;\r\n  if (!product_name || product_name.trim() === \"\") {\r\n    return res.status(400).json({ error: \"Product name is required\" });\r\n  }\r\n\r\n  const OPENAI_KEY = process.env.OPENAI_API_KEY;\r\n  if (!OPENAI_KEY) {\r\n    return res.status(500).json({ error: \"Missing OpenAI API key in environment\" });\r\n  }\r\n\r\n  const prompt = `\r\nYou are EcoSage, an assistant that helps users find sustainable alternatives to everyday products.\r\n\r\nGiven the product name: \"${product_name}\", suggest 1–3 eco-friendly alternatives available online.\r\nFor each, include:\r\n1. The product name\r\n2. A one-sentence reason why it’s eco-friendly\r\n3. A short product description (under 30 words)\r\n\r\nReturn only valid JSON in this format:\r\n{\r\n  \"suggestions\": [\r\n    {\r\n      \"name\": \"Example\",\r\n      \"reason\": \"Why it's sustainable\",\r\n      \"description\": \"Short description\"\r\n    }\r\n  ]\r\n}\r\n`;\r\n\r\n  try {\r\n    const response = await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${OPENAI_KEY}`,\r\n      },\r\n      body: JSON.stringify({\r\n        model: \"gpt-3.5-turbo\",\r\n        messages: [\r\n          { role: \"system\", content: \"You are a helpful assistant.\" },\r\n          { role: \"user\", content: prompt },\r\n        ],\r\n        max_tokens: 300,\r\n        temperature: 0.7,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errText = await response.text();\r\n      return res.status(500).json({ error: \"OpenAI API error\", details: errText });\r\n    }\r\n\r\n    const data = await response.json();\r\n    const text = data.choices?.[0]?.message?.content?.trim();\r\n\r\n    let json;\r\n    try {\r\n      json = JSON.parse(text);\r\n    } catch (err) {\r\n      const start = text.indexOf(\"{\");\r\n      const end = text.lastIndexOf(\"}\");\r\n      if (start !== -1 && end !== -1) {\r\n        const slice = text.slice(start, end + 1);\r\n        json = JSON.parse(slice);\r\n      } else {\r\n        throw err;\r\n      }\r\n    }\r\n\r\n    return res.status(200).json({ suggestions: json.suggestions });\r\n  } catch (error) {\r\n    console.error(error);\r\n    return res.status(500).json({ error: \"Server error\", details: error.message });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;AAER,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAA2B;IAClE;IAEA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI;IACjC,IAAI,CAAC,gBAAgB,aAAa,IAAI,OAAO,IAAI;QAC/C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAA2B;IAClE;IAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,cAAc;IAC7C,IAAI,CAAC,YAAY;QACf,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwC;IAC/E;IAEA,MAAM,SAAS,CAAC;;;yBAGO,EAAE,aAAa;;;;;;;;;;;;;;;;AAgBxC,CAAC;IAEC,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,iDAAiD;YAC5E,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,YAAY;YACvC;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO;gBACP,UAAU;oBACR;wBAAE,MAAM;wBAAU,SAAS;oBAA+B;oBAC1D;wBAAE,MAAM;wBAAQ,SAAS;oBAAO;iBACjC;gBACD,YAAY;gBACZ,aAAa;YACf;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,UAAU,MAAM,SAAS,IAAI;YACnC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;gBAAoB,SAAS;YAAQ;QAC5E;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,OAAO,KAAK,OAAO,EAAE,CAAC,EAAE,EAAE,SAAS,SAAS;QAElD,IAAI;QACJ,IAAI;YACF,OAAO,KAAK,KAAK,CAAC;QACpB,EAAE,OAAO,KAAK;YACZ,MAAM,QAAQ,KAAK,OAAO,CAAC;YAC3B,MAAM,MAAM,KAAK,WAAW,CAAC;YAC7B,IAAI,UAAU,CAAC,KAAK,QAAQ,CAAC,GAAG;gBAC9B,MAAM,QAAQ,KAAK,KAAK,CAAC,OAAO,MAAM;gBACtC,OAAO,KAAK,KAAK,CAAC;YACpB,OAAO;gBACL,MAAM;YACR;QACF;QAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,aAAa,KAAK,WAAW;QAAC;IAC9D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;YAAgB,SAAS,MAAM,OAAO;QAAC;IAC9E;AACF","debugId":null}}]
}